# 안드로이드 BLE 앱 개발 가이드

## 1. 개발 환경 설정

### 필요한 도구
- **Android Studio**: 최신 버전 설치 (Arctic Fox 이상 권장)
- **JDK**: Java Development Kit 11 이상
- **안드로이드 기기**: BLE 지원 스마트폰 (Android 5.0 이상)

### 프로젝트 생성
1. Android Studio 실행
2. "New Project" 선택
3. "Empty Activity" 템플릿 선택
4. 프로젝트 이름: `RGBSensorBLE` (또는 원하는 이름)
5. 패키지 이름: `com.example.rgbsensorble`
6. 최소 SDK: API 21 (Android 5.0) 이상
7. 언어: Java 또는 Kotlin 선택

---

## 2. 권한 설정

### AndroidManifest.xml에 추가

```xml
<!-- BLE 스캔 및 연결 권한 -->
<uses-permission android:name="android.permission.BLUETOOTH" />
<uses-permission android:name="android.permission.BLUETOOTH_ADMIN" />
<uses-permission android:name="android.permission.BLUETOOTH_SCAN" 
    android:usesPermissionFlags="neverForLocation" />
<uses-permission android:name="android.permission.BLUETOOTH_CONNECT" />

<!-- Android 12 (API 31) 이상을 위한 추가 권한 -->
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />

<!-- BLE 기능 필수 -->
<uses-feature android:name="android.hardware.bluetooth_le" android:required="true" />
```

### 런타임 권한 요청
Android 6.0 이상에서는 런타임에 위치 권한을 요청해야 합니다.

---

## 3. BLE UUID 설정

ESP32-S3와 동일한 UUID 사용:
- **Service UUID**: `4fafc201-1fb5-459e-8fcc-c5c9c331914b`
- **Characteristic UUID**: `beb5483e-36e1-4688-b7f5-ea07361b26a8`
- **디바이스 이름**: `ESP32_RGB_Sensor`

---

## 4. 주요 기능 구현

### 4.1 BLE 스캔
- 주변 BLE 디바이스 검색
- "ESP32_RGB_Sensor" 디바이스 찾기

### 4.2 BLE 연결
- 찾은 디바이스에 연결
- 서비스 및 특성 발견

### 4.3 데이터 수신
- Notification 구독
- "R255,G255,B255" 형식 데이터 파싱
- RGB 값 추출 및 화면 표시

### 4.4 연결 해제
- 연결 종료 처리
- 리소스 정리

---

## 5. 프로젝트 구조

```
RGBSensorBLE/
├── app/
│   ├── src/
│   │   ├── main/
│   │   │   ├── java/com/example/rgbsensorble/
│   │   │   │   ├── MainActivity.java (또는 .kt)
│   │   │   │   ├── BLEService.java (또는 .kt)
│   │   │   │   └── RGBData.java (또는 .kt)
│   │   │   ├── res/
│   │   │   │   ├── layout/
│   │   │   │   │   └── activity_main.xml
│   │   │   │   └── values/
│   │   │   │       └── strings.xml
│   │   │   └── AndroidManifest.xml
│   │   └── build.gradle
```

---

## 6. Gradle 의존성

### build.gradle (Module: app)
```gradle
dependencies {
    implementation 'androidx.appcompat:appcompat:1.6.1'
    implementation 'com.google.android.material:material:1.9.0'
    implementation 'androidx.constraintlayout:constraintlayout:2.1.4'
    
    // BLE 지원 라이브러리 (Android 기본 제공)
    // 별도 라이브러리 불필요
}
```

---

## 7. 개발 단계

1. **UI 레이아웃 설계**
   - 스캔 버튼
   - 연결 상태 표시
   - RGB 값 표시 영역
   - 색상 미리보기

2. **BLE 서비스 클래스 작성**
   - 스캔 로직
   - 연결 로직
   - 데이터 수신 로직

3. **MainActivity 구현**
   - UI 이벤트 처리
   - BLE 서비스와 통신
   - 데이터 표시

4. **테스트**
   - ESP32-S3와 실제 연결 테스트
   - 데이터 수신 확인

---

## 8. 주의사항

- **Android 12 (API 31) 이상**: BLUETOOTH_SCAN, BLUETOOTH_CONNECT 권한 필수
- **위치 권한**: BLE 스캔을 위해 위치 권한 필요 (Android 6.0+)
- **백그라운드 제한**: 앱이 백그라운드일 때 BLE 동작 제한 가능
- **메인 스레드**: BLE 콜백은 메인 스레드에서 UI 업데이트 필요

---

## 9. 다음 단계

실제 코드 예제는 별도 파일로 제공됩니다:
- `MainActivity.java` 또는 `MainActivity.kt`
- `BLEService.java` 또는 `BLEService.kt`
- `activity_main.xml` (레이아웃)


