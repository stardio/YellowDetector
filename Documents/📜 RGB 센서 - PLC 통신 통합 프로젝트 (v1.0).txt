📜 RGB 센서 - PLC 통신 통합 프로젝트 (v1.0)
본 프로젝트는 ESP32-S3를 활용하여 TCS34725 컬러 센서로부터 RGB 데이터를 취득하고, 
이를 RS485(Modbus RTU) 통신을 통해 **LS PLC(XGB 시리즈)**의 D-영역에 실시간으로 전송하는 시스템입니다.

🛠 1. 하드웨어 구성 및 핀 맵
Controller: ESP32-S3 (N16R8)

Sensor: TCS34725 컬러 센서 (I2C 통신)

Communication: RS485 (Modbus RTU Slave, ID: 1)

Baudrate: 115200 bps (안정성 확인 완료)

장치 기능,ESP32-S3 핀 번호,비고
I2C SDA,GPIO 41,컬러 센서 데이터 선
I2C SCL,GPIO 42,컬러 센서 클럭 선
RS485 RX,GPIO 18,컨버터 RO 핀 연결
RS485 TX,GPIO 17,컨버터 DI 핀 연결


📚 2. 필수 라이브러리 목록
컴파일을 위해 다음 라이브러리 설치가 필요합니다.

Modbus-ESP8266 (by Alexander Neiman)

역할: Modbus RTU Slave 프로토콜 구현

Wire (내장 라이브러리)

역할: I2C 센서 통신

BLE 관련 (ESP32 내장)

역할: 스마트폰 앱 전송용

🔢 3. Modbus & PLC 메모리 맵
데이터는 16비트(Word) 단위로 전송되며, PLC에서는 MOV 명령어를 사용하여 처리합니다.
데이터 항목,ESP32 주소 (Decimal),Modbus 주소 (Hex),PLC 저장 주소
Blue (B),257,0x30101,D100
Red (R),258,0x30102,D101
Green (G),259,0x30103,D102

⚙️ 4. 설정 시 주의사항
PLC P2P 설정:

통신 속도: 115200, 8-N-1 설정

기동 조건: _T100MS 또는 _ON (상시 기동)

읽기 개수: 3개 (연속 읽기)

응답 대기 시간(Timeout): 200ms~500ms 권장

데이터 처리:

PLC 래더에서 32비트 명령어인 DMOV 대신 16비트 명령어인 MOV를 반드시 사용해야 데이터 왜곡이 없습니다.

물리 결선:

통신 노이즈 방지를 위해 종단 저항(120Ω) 설치와 GND 라인 공유를 권장합니다.

📅 5. 히스토리
2026.01.25: 115200bps 통신 안정화 및 RGB 3축 데이터 전송 성공 (v1.0 완성)

개발자: 손대표님 & 제부장(AI)
